"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.fakeOra = void 0;

require("source-map-support/register");

require("colors");

var _debug = _interopRequireDefault(require("debug"));

var _ora = _interopRequireDefault(require("ora"));

var _prettyMs = _interopRequireDefault(require("pretty-ms"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:async-ora');
const useFakeOra = Boolean(process.env.DEBUG && process.env.DEBUG.includes('electron-forge'));

if (useFakeOra) {
  console.warn('WARNING: DEBUG environment variable detected.  Progress indicators will be sent over electron-forge:lifecycle'.red);
}

const fakeOra = name => {
  let oraName = name;
  let startTime = null;

  const timing = () => {
    if (!startTime) return;
    return `-- after ${`${(0, _prettyMs.default)(Date.now() - startTime)}`.cyan}`;
  };

  const fake = {
    start: () => {
      startTime = Date.now();
      d('Process Started:', fake.text);
      return fake;
    },
    fail: () => {
      d(`Process Failed: ${fake.text}`.red, timing);
      return fake;
    },
    succeed: () => {
      d('Process Succeeded:', fake.text, timing());
      return fake;
    },
    stop: () => {
      d('Process Stopped:', fake.text, timing());
      return fake;
    },
    warn: warning => {
      d('Process Warned:', warning, timing());
      return fake;
    },

    get text() {
      return oraName;
    },

    set text(newName) {
      d('Process Renamed:', oraName, ' --> ', newName);
      oraName = newName;
    }

  };
  return fake;
};

exports.fakeOra = fakeOra;

var _default = useFakeOra ? fakeOra : _ora.default;

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9vcmEudHMiXSwibmFtZXMiOlsiZCIsInVzZUZha2VPcmEiLCJCb29sZWFuIiwicHJvY2VzcyIsImVudiIsIkRFQlVHIiwiaW5jbHVkZXMiLCJjb25zb2xlIiwid2FybiIsInJlZCIsImZha2VPcmEiLCJuYW1lIiwib3JhTmFtZSIsInN0YXJ0VGltZSIsInRpbWluZyIsIkRhdGUiLCJub3ciLCJjeWFuIiwiZmFrZSIsInN0YXJ0IiwidGV4dCIsImZhaWwiLCJzdWNjZWVkIiwic3RvcCIsIndhcm5pbmciLCJuZXdOYW1lIiwicmVhbE9yYSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBRUE7O0FBRUE7Ozs7QUFFQSxNQUFNQSxDQUFDLEdBQUcsb0JBQU0sMEJBQU4sQ0FBVjtBQUVBLE1BQU1DLFVBQVUsR0FBR0MsT0FBTyxDQUFDQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsS0FBWixJQUFxQkYsT0FBTyxDQUFDQyxHQUFSLENBQVlDLEtBQVosQ0FBa0JDLFFBQWxCLENBQTJCLGdCQUEzQixDQUF0QixDQUExQjs7QUFFQSxJQUFJTCxVQUFKLEVBQWdCO0FBQ2RNLEVBQUFBLE9BQU8sQ0FBQ0MsSUFBUixDQUFhLGdIQUFnSEMsR0FBN0g7QUFDRDs7QUFFTSxNQUFNQyxPQUFPLEdBQUlDLElBQUQsSUFBa0I7QUFDdkMsTUFBSUMsT0FBTyxHQUFHRCxJQUFkO0FBQ0EsTUFBSUUsU0FBd0IsR0FBRyxJQUEvQjs7QUFDQSxRQUFNQyxNQUFNLEdBQUcsTUFBTTtBQUNuQixRQUFJLENBQUNELFNBQUwsRUFBZ0I7QUFDaEIsV0FBUSxZQUFZLEdBQUUsdUJBQVNFLElBQUksQ0FBQ0MsR0FBTCxLQUFhSCxTQUF0QixDQUFpQyxFQUFwQyxDQUFzQ0ksSUFBSyxFQUE5RDtBQUNELEdBSEQ7O0FBSUEsUUFBTUMsSUFBYSxHQUFHO0FBQ3BCQyxJQUFBQSxLQUFLLEVBQUUsTUFBTTtBQUNYTixNQUFBQSxTQUFTLEdBQUdFLElBQUksQ0FBQ0MsR0FBTCxFQUFaO0FBQ0FoQixNQUFBQSxDQUFDLENBQUMsa0JBQUQsRUFBcUJrQixJQUFJLENBQUNFLElBQTFCLENBQUQ7QUFDQSxhQUFPRixJQUFQO0FBQ0QsS0FMbUI7QUFNcEJHLElBQUFBLElBQUksRUFBRSxNQUFNO0FBQ1ZyQixNQUFBQSxDQUFDLENBQUUsbUJBQWtCa0IsSUFBSSxDQUFDRSxJQUFLLEVBQTdCLENBQStCWCxHQUFoQyxFQUFxQ0ssTUFBckMsQ0FBRDtBQUNBLGFBQU9JLElBQVA7QUFDRCxLQVRtQjtBQVVwQkksSUFBQUEsT0FBTyxFQUFFLE1BQU07QUFDYnRCLE1BQUFBLENBQUMsQ0FBQyxvQkFBRCxFQUF1QmtCLElBQUksQ0FBQ0UsSUFBNUIsRUFBa0NOLE1BQU0sRUFBeEMsQ0FBRDtBQUNBLGFBQU9JLElBQVA7QUFDRCxLQWJtQjtBQWNwQkssSUFBQUEsSUFBSSxFQUFFLE1BQU07QUFDVnZCLE1BQUFBLENBQUMsQ0FBQyxrQkFBRCxFQUFxQmtCLElBQUksQ0FBQ0UsSUFBMUIsRUFBZ0NOLE1BQU0sRUFBdEMsQ0FBRDtBQUNBLGFBQU9JLElBQVA7QUFDRCxLQWpCbUI7QUFrQnBCVixJQUFBQSxJQUFJLEVBQUdnQixPQUFELElBQXFCO0FBQ3pCeEIsTUFBQUEsQ0FBQyxDQUFDLGlCQUFELEVBQW9Cd0IsT0FBcEIsRUFBNkJWLE1BQU0sRUFBbkMsQ0FBRDtBQUNBLGFBQU9JLElBQVA7QUFDRCxLQXJCbUI7O0FBc0JwQixRQUFJRSxJQUFKLEdBQVc7QUFDVCxhQUFPUixPQUFQO0FBQ0QsS0F4Qm1COztBQXlCcEIsUUFBSVEsSUFBSixDQUFTSyxPQUFULEVBQTBCO0FBQ3hCekIsTUFBQUEsQ0FBQyxDQUFDLGtCQUFELEVBQXFCWSxPQUFyQixFQUE4QixPQUE5QixFQUF1Q2EsT0FBdkMsQ0FBRDtBQUNBYixNQUFBQSxPQUFPLEdBQUdhLE9BQVY7QUFDRDs7QUE1Qm1CLEdBQXRCO0FBOEJBLFNBQU9QLElBQVA7QUFDRCxDQXRDTTs7OztlQXdDUWpCLFVBQVUsR0FBR1MsT0FBSCxHQUFhZ0IsWSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnY29sb3JzJztcbmltcG9ydCBkZWJ1ZyBmcm9tICdkZWJ1Zyc7XG5pbXBvcnQgbG9nU3ltYm9scyBmcm9tICdsb2ctc3ltYm9scyc7XG5pbXBvcnQgcmVhbE9yYSBmcm9tICdvcmEnO1xuaW1wb3J0IHsgT3JhSW1wbCB9IGZyb20gJy4vb3JhLWhhbmRsZXInO1xuaW1wb3J0IHByZXR0eU1zIGZyb20gJ3ByZXR0eS1tcyc7XG5cbmNvbnN0IGQgPSBkZWJ1ZygnZWxlY3Ryb24tZm9yZ2U6YXN5bmMtb3JhJyk7XG5cbmNvbnN0IHVzZUZha2VPcmEgPSBCb29sZWFuKHByb2Nlc3MuZW52LkRFQlVHICYmIHByb2Nlc3MuZW52LkRFQlVHLmluY2x1ZGVzKCdlbGVjdHJvbi1mb3JnZScpKTtcblxuaWYgKHVzZUZha2VPcmEpIHtcbiAgY29uc29sZS53YXJuKCdXQVJOSU5HOiBERUJVRyBlbnZpcm9ubWVudCB2YXJpYWJsZSBkZXRlY3RlZC4gIFByb2dyZXNzIGluZGljYXRvcnMgd2lsbCBiZSBzZW50IG92ZXIgZWxlY3Ryb24tZm9yZ2U6bGlmZWN5Y2xlJy5yZWQpO1xufVxuXG5leHBvcnQgY29uc3QgZmFrZU9yYSA9IChuYW1lOiBzdHJpbmcpID0+IHtcbiAgbGV0IG9yYU5hbWUgPSBuYW1lO1xuICBsZXQgc3RhcnRUaW1lOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgY29uc3QgdGltaW5nID0gKCkgPT4ge1xuICAgIGlmICghc3RhcnRUaW1lKSByZXR1cm47XG4gICAgcmV0dXJuIGAtLSBhZnRlciAke2Ake3ByZXR0eU1zKERhdGUubm93KCkgLSBzdGFydFRpbWUpfWAuY3lhbn1gO1xuICB9O1xuICBjb25zdCBmYWtlOiBPcmFJbXBsID0ge1xuICAgIHN0YXJ0OiAoKSA9PiB7XG4gICAgICBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgZCgnUHJvY2VzcyBTdGFydGVkOicsIGZha2UudGV4dCk7XG4gICAgICByZXR1cm4gZmFrZTtcbiAgICB9LFxuICAgIGZhaWw6ICgpID0+IHtcbiAgICAgIGQoYFByb2Nlc3MgRmFpbGVkOiAke2Zha2UudGV4dH1gLnJlZCwgdGltaW5nKTtcbiAgICAgIHJldHVybiBmYWtlO1xuICAgIH0sXG4gICAgc3VjY2VlZDogKCkgPT4ge1xuICAgICAgZCgnUHJvY2VzcyBTdWNjZWVkZWQ6JywgZmFrZS50ZXh0LCB0aW1pbmcoKSk7XG4gICAgICByZXR1cm4gZmFrZTtcbiAgICB9LFxuICAgIHN0b3A6ICgpID0+IHtcbiAgICAgIGQoJ1Byb2Nlc3MgU3RvcHBlZDonLCBmYWtlLnRleHQsIHRpbWluZygpKTtcbiAgICAgIHJldHVybiBmYWtlO1xuICAgIH0sXG4gICAgd2FybjogKHdhcm5pbmc6IHN0cmluZykgPT4ge1xuICAgICAgZCgnUHJvY2VzcyBXYXJuZWQ6Jywgd2FybmluZywgdGltaW5nKCkpO1xuICAgICAgcmV0dXJuIGZha2U7XG4gICAgfSxcbiAgICBnZXQgdGV4dCgpIHtcbiAgICAgIHJldHVybiBvcmFOYW1lO1xuICAgIH0sXG4gICAgc2V0IHRleHQobmV3TmFtZTogc3RyaW5nKSB7XG4gICAgICBkKCdQcm9jZXNzIFJlbmFtZWQ6Jywgb3JhTmFtZSwgJyAtLT4gJywgbmV3TmFtZSk7XG4gICAgICBvcmFOYW1lID0gbmV3TmFtZTtcbiAgICB9LFxuICB9O1xuICByZXR1cm4gZmFrZTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHVzZUZha2VPcmEgPyBmYWtlT3JhIDogcmVhbE9yYTtcbiJdfQ==