"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.OraImpl = void 0;

require("source-map-support/register");

var _colors = _interopRequireDefault(require("colors"));

var _ora = _interopRequireDefault(require("./ora"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class OraImpl {
  constructor(text = '') {
    this.text = text;
  }

  succeed(symbol) {
    return this;
  }

  fail(symbol) {
    return this;
  }

  start() {
    return this;
  }

  stop(symbol) {
    return this;
  }

  warn(message) {
    return this;
  }

}

exports.OraImpl = OraImpl;

const asyncOra = (initialOraValue, asyncFn, processExitFn = process.exit) => {
  let fnOra = new OraImpl(initialOraValue);

  if (asyncOra.interactive) {
    fnOra = (0, _ora.default)(initialOraValue).start();
  }

  return new Promise((resolve, reject) => {
    asyncFn(fnOra).then(() => {
      fnOra.succeed();
      resolve();
    }).catch(err => {
      fnOra.fail();

      if (asyncOra.interactive) {
        if (err && err.message && err.stack) {
          console.error('\nAn unhandled error has occurred inside Forge:'.red);
          console.error(_colors.default.red(err.message));
          console.error(_colors.default.red(err.stack));
        } else {
          console.error('\nElectron forge was terminated:'.red);
          console.error(_colors.default.red(typeof err === 'string' ? err : JSON.stringify(err)));
        }

        processExitFn(1); // If the process is still alive we should continue because either
        // something went really wrong or we are testing this function

        setTimeout(() => resolve(), 500);
      } else {
        reject(err);
      }
    });
  });
};

asyncOra.interactive = true;
var _default = asyncOra;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9vcmEtaGFuZGxlci50cyJdLCJuYW1lcyI6WyJPcmFJbXBsIiwiY29uc3RydWN0b3IiLCJ0ZXh0Iiwic3VjY2VlZCIsInN5bWJvbCIsImZhaWwiLCJzdGFydCIsInN0b3AiLCJ3YXJuIiwibWVzc2FnZSIsImFzeW5jT3JhIiwiaW5pdGlhbE9yYVZhbHVlIiwiYXN5bmNGbiIsInByb2Nlc3NFeGl0Rm4iLCJwcm9jZXNzIiwiZXhpdCIsImZuT3JhIiwiaW50ZXJhY3RpdmUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInRoZW4iLCJjYXRjaCIsImVyciIsInN0YWNrIiwiY29uc29sZSIsImVycm9yIiwicmVkIiwiY29sb3JzIiwiSlNPTiIsInN0cmluZ2lmeSIsInNldFRpbWVvdXQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOzs7O0FBRU8sTUFBTUEsT0FBTixDQUFjO0FBQ25CQyxFQUFBQSxXQUFXLENBQVFDLElBQVksR0FBRyxFQUF2QixFQUEyQjtBQUFBO0FBQUU7O0FBRXhDQyxFQUFBQSxPQUFPLENBQUNDLE1BQUQsRUFBa0I7QUFBRSxXQUFPLElBQVA7QUFBYzs7QUFDekNDLEVBQUFBLElBQUksQ0FBQ0QsTUFBRCxFQUFrQjtBQUFFLFdBQU8sSUFBUDtBQUFjOztBQUN0Q0UsRUFBQUEsS0FBSyxHQUFHO0FBQUUsV0FBTyxJQUFQO0FBQWM7O0FBQ3hCQyxFQUFBQSxJQUFJLENBQUNILE1BQUQsRUFBa0I7QUFBRSxXQUFPLElBQVA7QUFBYzs7QUFDdENJLEVBQUFBLElBQUksQ0FBQ0MsT0FBRCxFQUFrQjtBQUFFLFdBQU8sSUFBUDtBQUFjOztBQVBuQjs7OztBQW1CckIsTUFBTUMsUUFBd0IsR0FBRyxDQUFDQyxlQUFELEVBQWtCQyxPQUFsQixFQUEyQkMsYUFBYSxHQUFHQyxPQUFPLENBQUNDLElBQW5ELEtBQTREO0FBQzNGLE1BQUlDLEtBQUssR0FBRyxJQUFJaEIsT0FBSixDQUFZVyxlQUFaLENBQVo7O0FBQ0EsTUFBSUQsUUFBUSxDQUFDTyxXQUFiLEVBQTBCO0FBQ3hCRCxJQUFBQSxLQUFLLEdBQUcsa0JBQUlMLGVBQUosRUFBcUJMLEtBQXJCLEVBQVI7QUFDRDs7QUFDRCxTQUFPLElBQUlZLE9BQUosQ0FBWSxDQUFDQyxPQUFELEVBQVVDLE1BQVYsS0FBcUI7QUFDdENSLElBQUFBLE9BQU8sQ0FBQ0ksS0FBRCxDQUFQLENBQWVLLElBQWYsQ0FBb0IsTUFBTTtBQUN4QkwsTUFBQUEsS0FBSyxDQUFDYixPQUFOO0FBQ0FnQixNQUFBQSxPQUFPO0FBQ1IsS0FIRCxFQUdHRyxLQUhILENBR1VDLEdBQUQsSUFBUztBQUNoQlAsTUFBQUEsS0FBSyxDQUFDWCxJQUFOOztBQUNBLFVBQUlLLFFBQVEsQ0FBQ08sV0FBYixFQUEwQjtBQUN4QixZQUFJTSxHQUFHLElBQUlBLEdBQUcsQ0FBQ2QsT0FBWCxJQUFzQmMsR0FBRyxDQUFDQyxLQUE5QixFQUFxQztBQUNuQ0MsVUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWMsa0RBQWtEQyxHQUFoRTtBQUNBRixVQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBY0UsZ0JBQU9ELEdBQVAsQ0FBV0osR0FBRyxDQUFDZCxPQUFmLENBQWQ7QUFDQWdCLFVBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjRSxnQkFBT0QsR0FBUCxDQUFXSixHQUFHLENBQUNDLEtBQWYsQ0FBZDtBQUNELFNBSkQsTUFJTztBQUNMQyxVQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBYyxtQ0FBbUNDLEdBQWpEO0FBQ0FGLFVBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjRSxnQkFBT0QsR0FBUCxDQUFXLE9BQU9KLEdBQVAsS0FBZSxRQUFmLEdBQTBCQSxHQUExQixHQUFnQ00sSUFBSSxDQUFDQyxTQUFMLENBQWVQLEdBQWYsQ0FBM0MsQ0FBZDtBQUNEOztBQUNEVixRQUFBQSxhQUFhLENBQUMsQ0FBRCxDQUFiLENBVHdCLENBVXhCO0FBQ0E7O0FBQ0FrQixRQUFBQSxVQUFVLENBQUMsTUFBTVosT0FBTyxFQUFkLEVBQWtCLEdBQWxCLENBQVY7QUFDRCxPQWJELE1BYU87QUFDTEMsUUFBQUEsTUFBTSxDQUFDRyxHQUFELENBQU47QUFDRDtBQUNGLEtBckJEO0FBc0JELEdBdkJNLENBQVA7QUF3QkQsQ0E3QkQ7O0FBK0JBYixRQUFRLENBQUNPLFdBQVQsR0FBdUIsSUFBdkI7ZUFFZVAsUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjb2xvcnMgZnJvbSAnY29sb3JzJztcbmltcG9ydCBvcmEgZnJvbSAnLi9vcmEnO1xuXG5leHBvcnQgY2xhc3MgT3JhSW1wbCB7XG4gIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZXh0OiBzdHJpbmcgPSAnJykge31cblxuICBzdWNjZWVkKHN5bWJvbD86IHN0cmluZykgeyByZXR1cm4gdGhpczsgfVxuICBmYWlsKHN5bWJvbD86IHN0cmluZykgeyByZXR1cm4gdGhpczsgfVxuICBzdGFydCgpIHsgcmV0dXJuIHRoaXM7IH1cbiAgc3RvcChzeW1ib2w/OiBzdHJpbmcpIHsgcmV0dXJuIHRoaXM7IH1cbiAgd2FybihtZXNzYWdlOiBzdHJpbmcpIHsgcmV0dXJuIHRoaXM7IH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBBc3luY09yYU1ldGhvZCB7XG4gIChcbiAgICBpbml0aWFsT3JhVmFsdWU6IHN0cmluZyxcbiAgICBhc3luY0ZuOiAob3JhOiBPcmFJbXBsKSA9PiBQcm9taXNlPHZvaWQ+LFxuICAgIHByb2Nlc3NFeGl0Rm4/OiAoY29kZTogbnVtYmVyKSA9PiB2b2lkLFxuICApOiBQcm9taXNlPHZvaWQ+O1xuICBpbnRlcmFjdGl2ZT86IGJvb2xlYW47XG59XG5cbmNvbnN0IGFzeW5jT3JhOiBBc3luY09yYU1ldGhvZCA9IChpbml0aWFsT3JhVmFsdWUsIGFzeW5jRm4sIHByb2Nlc3NFeGl0Rm4gPSBwcm9jZXNzLmV4aXQpID0+IHtcbiAgbGV0IGZuT3JhID0gbmV3IE9yYUltcGwoaW5pdGlhbE9yYVZhbHVlKTtcbiAgaWYgKGFzeW5jT3JhLmludGVyYWN0aXZlKSB7XG4gICAgZm5PcmEgPSBvcmEoaW5pdGlhbE9yYVZhbHVlKS5zdGFydCgpO1xuICB9XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgYXN5bmNGbihmbk9yYSkudGhlbigoKSA9PiB7XG4gICAgICBmbk9yYS5zdWNjZWVkKCk7XG4gICAgICByZXNvbHZlKCk7XG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgZm5PcmEuZmFpbCgpO1xuICAgICAgaWYgKGFzeW5jT3JhLmludGVyYWN0aXZlKSB7XG4gICAgICAgIGlmIChlcnIgJiYgZXJyLm1lc3NhZ2UgJiYgZXJyLnN0YWNrKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignXFxuQW4gdW5oYW5kbGVkIGVycm9yIGhhcyBvY2N1cnJlZCBpbnNpZGUgRm9yZ2U6Jy5yZWQpO1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoY29sb3JzLnJlZChlcnIubWVzc2FnZSkpO1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoY29sb3JzLnJlZChlcnIuc3RhY2spKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdcXG5FbGVjdHJvbiBmb3JnZSB3YXMgdGVybWluYXRlZDonLnJlZCk7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihjb2xvcnMucmVkKHR5cGVvZiBlcnIgPT09ICdzdHJpbmcnID8gZXJyIDogSlNPTi5zdHJpbmdpZnkoZXJyKSkpO1xuICAgICAgICB9XG4gICAgICAgIHByb2Nlc3NFeGl0Rm4oMSk7XG4gICAgICAgIC8vIElmIHRoZSBwcm9jZXNzIGlzIHN0aWxsIGFsaXZlIHdlIHNob3VsZCBjb250aW51ZSBiZWNhdXNlIGVpdGhlclxuICAgICAgICAvLyBzb21ldGhpbmcgd2VudCByZWFsbHkgd3Jvbmcgb3Igd2UgYXJlIHRlc3RpbmcgdGhpcyBmdW5jdGlvblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlc29sdmUoKSwgNTAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG5cbmFzeW5jT3JhLmludGVyYWN0aXZlID0gdHJ1ZTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmNPcmE7XG4iXX0=